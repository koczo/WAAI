@using WAAI.Features.Wizard.Steps.Personal
@using FluentValidation
@inject IValidator<PersonalInfo> Validator

<div class="space-y-4">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">Personal Information</h2>
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label>
        <input @bind="PersonalInfo.FullName" @bind:event="oninput" type="text" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none" placeholder="John Doe" />
        @if (GetError(nameof(PersonalInfo.FullName)) is { } fullNameError)
        {
            <p class="text-red-500 text-sm mt-1">@fullNameError</p>
        }
    </div>
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Email <span class="text-red-500">*</span></label>
        <input @bind="PersonalInfo.Email" @bind:event="oninput" type="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none" placeholder="john@example.com" />
        @if (GetError(nameof(PersonalInfo.Email)) is { } emailError)
        {
            <p class="text-red-500 text-sm mt-1">@emailError</p>
        }
    </div>
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Phone <span class="text-red-500">*</span></label>
        <input @bind="PersonalInfo.Phone" @bind:event="oninput" type="tel" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none" placeholder="+1 234 567 890" />
        @if (GetError(nameof(PersonalInfo.Phone)) is { } phoneError)
        {
            <p class="text-red-500 text-sm mt-1">@phoneError</p>
        }
    </div>
</div>

@code {
    [Parameter] public PersonalInfo PersonalInfo { get; set; } = new();

    private string? GetError(string propertyName)
    {
        var result = Validator.Validate(PersonalInfo);
        return result.Errors.FirstOrDefault(e => e.PropertyName == propertyName)?.ErrorMessage;
    }
}
